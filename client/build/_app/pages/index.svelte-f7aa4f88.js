import{S as e,i as t,s,l as a,f as l,d as n,e as r,t as o,c,a as i,g as d,b as f,E as h,h as u,H as m,I as p,k as v,n as g,v as b,r as x,u as y,J as E,z as S,y as N,K as P,B as O,L as T,M as I,N as k,O as q,P as w,Q as U,R as _,T as B}from"../chunks/vendor-0d7a9b8a.js";function M(e,t,s){const a=e.slice();return a[13]=t[s],a}function L(e,t,s){const a=e.slice();return a[16]=t[s].from,a[17]=t[s].text,a[18]=t[s].to,a}function R(e){let t,s,a,m,p,b,x,y,E,S,N=e[16]+"",P=e[18]+"",O=e[17]+"";return{c(){t=r("p"),s=o(N),a=o(" → "),m=o(P),b=v(),x=r("p"),y=o(O),E=v(),this.h()},l(e){t=c(e,"P",{class:!0,m:!0});var l=i(t);s=d(l,N),a=d(l," → "),m=d(l,P),l.forEach(n),b=g(e),x=c(e,"P",{class:!0,bg:!0,text:!0,p:!0,border:!0});var r=i(x);y=d(r,O),E=g(r),r.forEach(n),this.h()},h(){f(t,"class",p=e[16]===e[1].name?"self-end":"self-start"),f(t,"m","t-2"),f(x,"class",S=e[16]===e[1].name?"self-end":"self-start"),f(x,"bg","blue-600"),f(x,"text","light-300"),f(x,"p","2"),f(x,"border","rounded")},m(e,n){l(e,t,n),h(t,s),h(t,a),h(t,m),l(e,b,n),l(e,x,n),h(x,y),h(x,E)},p(e,a){1&a&&N!==(N=e[16]+"")&&u(s,N),1&a&&P!==(P=e[18]+"")&&u(m,P),3&a&&p!==(p=e[16]===e[1].name?"self-end":"self-start")&&f(t,"class",p),1&a&&O!==(O=e[17]+"")&&u(y,O),3&a&&S!==(S=e[16]===e[1].name?"self-end":"self-start")&&f(x,"class",S)},d(e){e&&n(t),e&&n(b),e&&n(x)}}}function W(e){let t,s,a=e[17]+"";return{c(){t=r("p"),s=o(a),this.h()},l(e){t=c(e,"P",{bg:!0,m:!0,p:!0,border:!0});var l=i(t);s=d(l,a),l.forEach(n),this.h()},h(){f(t,"bg","orange-600"),f(t,"m","t-2"),f(t,"p","2"),f(t,"border","rounded")},m(e,a){l(e,t,a),h(t,s)},p(e,t){1&t&&a!==(a=e[17]+"")&&u(s,a)},d(e){e&&n(t)}}}function A(e){let t;function s(e,t){return"Server"===e[16]?W:R}let r=s(e),o=r(e);return{c(){o.c(),t=a()},l(e){o.l(e),t=a()},m(e,s){o.m(e,s),l(e,t,s)},p(e,a){r===(r=s(e))&&o?o.p(e,a):(o.d(1),o=r(e),o&&(o.c(),o.m(t.parentNode,t)))},d(e){o.d(e),e&&n(t)}}}function D(e){let t,s,a,v;return{c(){t=r("p"),s=o(e[4]),this.h()},l(a){t=c(a,"P",{p:!0,bg:!0,text:!0});var l=i(t);s=d(l,e[4]),l.forEach(n),this.h()},h(){f(t,"p","4"),f(t,"bg","red-600"),f(t,"text","light-300")},m(e,a){l(e,t,a),h(t,s),v=!0},p(e,t){(!v||16&t)&&u(s,e[4])},i(e){v||(m((()=>{a||(a=p(t,P,{},!0)),a.run(1)})),v=!0)},o(e){a||(a=p(t,P,{},!1)),a.run(0),v=!1},d(e){e&&n(t),e&&a&&a.end()}}}function V(e){let t,s,a,p,b,x,y,E,S,N,P,O,T,L,R,W,A,D,V=e[1].name+"",$=[],J=new Map,F=e[3];const H=e=>e[13].name;for(let l=0;l<F.length;l+=1){let t=M(e,F,l),s=H(t);J.set(s,$[l]=C(s,t))}return{c(){t=r("p"),s=o("Welcome, "),a=o(V),p=v(),b=r("label"),x=o("Send to"),y=v(),E=r("select");for(let e=0;e<$.length;e+=1)$[e].c();S=v(),N=r("form"),P=r("div"),O=r("input"),T=v(),L=r("button"),R=o("Send Message"),this.h()},l(e){t=c(e,"P",{});var l=i(t);s=d(l,"Welcome, "),a=d(l,V),l.forEach(n),p=g(e),b=c(e,"LABEL",{for:!0,m:!0});var r=i(b);x=d(r,"Send to"),r.forEach(n),y=g(e),E=c(e,"SELECT",{id:!0,w:!0,class:!0});var o=i(E);for(let t=0;t<$.length;t+=1)$[t].l(o);o.forEach(n),S=g(e),N=c(e,"FORM",{m:!0});var f=i(N);P=c(f,"DIV",{display:!0});var h=i(P);O=c(h,"INPUT",{flex:!0,id:!0,type:!0,class:!0}),T=g(h),L=c(h,"BUTTON",{type:!0,class:!0});var u=i(L);R=d(u,"Send Message"),u.forEach(n),h.forEach(n),f.forEach(n),this.h()},h(){f(b,"for","to"),f(b,"m","r-1"),f(E,"id","to"),f(E,"w","min-12"),f(E,"class","svelte-1lavqcd"),void 0===e[2].to&&m((()=>e[9].call(E))),f(O,"flex","1"),f(O,"id","message"),f(O,"type","text"),f(O,"class","svelte-1lavqcd"),L.disabled=W=e[2].text.length<1,f(L,"type","submit"),f(L,"class","svelte-1lavqcd"),f(P,"display","flex"),f(N,"m","t-4")},m(n,r){l(n,t,r),h(t,s),h(t,a),l(n,p,r),l(n,b,r),h(b,x),l(n,y,r),l(n,E,r);for(let e=0;e<$.length;e+=1)$[e].m(E,null);I(E,e[2].to),l(n,S,r),l(n,N,r),h(N,P),h(P,O),k(O,e[2].text),h(P,T),h(P,L),h(L,R),A||(D=[q(E,"change",e[9]),q(O,"input",e[10]),q(N,"submit",w(e[6]))],A=!0)},p(e,t){2&t&&V!==(V=e[1].name+"")&&u(a,V),10&t&&(F=e[3],$=U($,t,H,1,e,F,J,E,B,C,null,M)),12&t&&I(E,e[2].to),12&t&&O.value!==e[2].text&&k(O,e[2].text),12&t&&W!==(W=e[2].text.length<1)&&(L.disabled=W)},d(e){e&&n(t),e&&n(p),e&&n(b),e&&n(y),e&&n(E);for(let t=0;t<$.length;t+=1)$[t].d();e&&n(S),e&&n(N),A=!1,_(D)}}}function $(e){let t,s,a,u,m,p,b,x,y,E,S,N,P,O;return{c(){t=r("form"),s=r("label"),a=o("Username"),u=v(),m=r("div"),p=r("input"),b=v(),x=r("button"),y=o("Request Username"),S=v(),N=r("br"),this.h()},l(e){t=c(e,"FORM",{});var l=i(t);s=c(l,"LABEL",{for:!0});var r=i(s);a=d(r,"Username"),r.forEach(n),u=g(l),m=c(l,"DIV",{m:!0,display:!0});var o=i(m);p=c(o,"INPUT",{flex:!0,id:!0,type:!0,class:!0}),b=g(o),x=c(o,"BUTTON",{type:!0,class:!0});var f=i(x);y=d(f,"Request Username"),f.forEach(n),o.forEach(n),l.forEach(n),S=g(e),N=c(e,"BR",{}),this.h()},h(){var t;f(s,"for","username"),f(p,"flex","1"),f(p,"id","username"),f(p,"type","text"),f(p,"class","svelte-1lavqcd"),x.disabled=E=(null==(t=e[5])?void 0:t.length)<1,f(x,"type","submit"),f(x,"class","svelte-1lavqcd"),f(m,"m","t-2"),f(m,"display","flex")},m(n,r){l(n,t,r),h(t,s),h(s,a),h(t,u),h(t,m),h(m,p),k(p,e[5]),h(m,b),h(m,x),h(x,y),l(n,S,r),l(n,N,r),P||(O=[q(p,"input",e[8]),q(t,"submit",w(e[7]))],P=!0)},p(e,t){var s;32&t&&p.value!==e[5]&&k(p,e[5]),32&t&&E!==(E=(null==(s=e[5])?void 0:s.length)<1)&&(x.disabled=E)},d(e){e&&n(t),e&&n(S),e&&n(N),P=!1,_(O)}}}function J(e){let t,s,a,m=e[13].name+"";return{c(){t=r("option"),s=o(m),this.h()},l(e){t=c(e,"OPTION",{class:!0});var a=i(t);s=d(a,m),a.forEach(n),this.h()},h(){t.__value=a=e[13].name,t.value=t.__value,f(t,"class","svelte-1lavqcd")},m(e,a){l(e,t,a),h(t,s)},p(e,l){8&l&&m!==(m=e[13].name+"")&&u(s,m),8&l&&a!==(a=e[13].name)&&(t.__value=a,t.value=t.__value)},d(e){e&&n(t)}}}function C(e,t){let s,r,o="Server"!=t[13].name&&t[13].name!=t[1].name&&J(t);return{key:e,first:null,c(){s=a(),o&&o.c(),r=a(),this.h()},l(e){s=a(),o&&o.l(e),r=a(),this.h()},h(){this.first=s},m(e,t){l(e,s,t),o&&o.m(e,t),l(e,r,t)},p(e,s){"Server"!=(t=e)[13].name&&t[13].name!=t[1].name?o?o.p(t,s):(o=J(t),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},d(e){e&&n(s),o&&o.d(e),e&&n(r)}}}function F(e){let t,s,a,m,p,S,N,P,T,I,k,q,w,U=e[3].length-2+"",_=e[0],B=[];for(let l=0;l<_.length;l+=1)B[l]=A(L(e,_,l));let M=e[4]&&D(e);function R(e,t){return e[1].name?V:$}let W=R(e),J=W(e);return{c(){t=r("div"),s=r("p"),a=o("Number of users: "),m=o(U),p=v(),S=r("div"),N=r("p"),P=o("Start of conversation"),T=v();for(let e=0;e<B.length;e+=1)B[e].c();I=v(),M&&M.c(),k=v(),q=r("div"),J.c(),this.h()},l(e){t=c(e,"DIV",{bg:!0,p:!0});var l=i(t);s=c(l,"P",{text:!0});var r=i(s);a=d(r,"Number of users: "),m=d(r,U),r.forEach(n),l.forEach(n),p=g(e),S=c(e,"DIV",{id:!0,display:!0,flex:!0,p:!0,overflow:!0,class:!0});var o=i(S);N=c(o,"P",{font:!0});var f=i(N);P=d(f,"Start of conversation"),f.forEach(n),T=g(o);for(let t=0;t<B.length;t+=1)B[t].l(o);o.forEach(n),I=g(e),M&&M.l(e),k=g(e),q=c(e,"DIV",{bg:!0,p:!0});var h=i(q);J.l(h),h.forEach(n),this.h()},h(){f(s,"text","light-300"),f(t,"bg","dark-300"),f(t,"p","4"),f(N,"font","italic"),f(S,"id","messages"),f(S,"display","flex"),f(S,"flex","1 col"),f(S,"p","y-4 l-4"),f(S,"overflow","y-scroll"),f(S,"class","svelte-1lavqcd"),f(q,"bg","dark-300"),f(q,"p","4")},m(e,n){l(e,t,n),h(t,s),h(s,a),h(s,m),l(e,p,n),l(e,S,n),h(S,N),h(N,P),h(S,T);for(let t=0;t<B.length;t+=1)B[t].m(S,null);l(e,I,n),M&&M.m(e,n),l(e,k,n),l(e,q,n),J.m(q,null),w=!0},p(e,[t]){if((!w||8&t)&&U!==(U=e[3].length-2+"")&&u(m,U),3&t){let s;for(_=e[0],s=0;s<_.length;s+=1){const a=L(e,_,s);B[s]?B[s].p(a,t):(B[s]=A(a),B[s].c(),B[s].m(S,null))}for(;s<B.length;s+=1)B[s].d(1);B.length=_.length}e[4]?M?(M.p(e,t),16&t&&b(M,1)):(M=D(e),M.c(),b(M,1),M.m(k.parentNode,k)):M&&(O(),x(M,1,1,(()=>{M=null})),y()),W===(W=R(e))&&J?J.p(e,t):(J.d(1),J=W(e),J&&(J.c(),J.m(q,null)))},i(e){w||(b(M),w=!0)},o(e){x(M),w=!1},d(e){e&&n(t),e&&n(p),e&&n(S),E(B,e),e&&n(I),M&&M.d(e),e&&n(k),e&&n(q),J.d()}}}function H(e,t,s){const a={name:""},l={from:"",text:"Hello, World!",to:"All"};let n,r=[{name:"All"},{name:"Server"}],o="",c=[],i=`Guest #${(9999*Math.random()).toFixed(0)}`;function d(e){s(4,o=e),setTimeout((()=>s(4,o="")),2500)}return S((()=>{n=new WebSocket("ws://localhost:3000"),n.onclose=function(e){d("Connection to the server was lost.")},n.onerror=function(e){d("Connection to the server was lost.")},n.onmessage=function(e){const t=JSON.parse(e.data);if("message"===t.type){const e=t.data;s(0,c=[...c,e])}else if("update"===t.type){const e=t.data;t.success?(s(1,a.name=e.name,a),s(2,l.from=e.name,l)):d("That username is taken!")}else"list"===t.type&&(s(3,r=t.data),s(2,l.to=-1!=r.findIndex((e=>e.name===l.to))?l.to:"All",l))}})),e.$$.update=()=>{1&e.$$.dirty&&c&&N((()=>{const e=document.getElementById("messages");e.scrollTop=e.scrollHeight}))},[c,a,l,r,o,i,function(){const e={type:"message",data:l};n.readyState===WebSocket.OPEN?(n.send(JSON.stringify(e)),s(2,l.text="",l)):d("Server is unresponsive.")},function(){const e={type:"update",data:{name:i}};n.readyState===WebSocket.OPEN?n.send(JSON.stringify(e)):d("Server is unresponsive.")},function(){i=this.value,s(5,i)},function(){l.to=T(this),s(2,l),s(3,r)},function(){l.text=this.value,s(2,l),s(3,r)}]}export default class extends e{constructor(e){super(),t(this,e,H,F,s,{})}}
