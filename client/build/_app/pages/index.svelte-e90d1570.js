import{S as e,i as t,s as a,l as s,f as l,d as n,e as r,t as o,c,a as i,g as d,b as h,E as u,h as f,H as m,I as p,k as v,n as g,v as b,r as E,u as x,J as y,z as N,y as S,K as T,B as I,L as P,M as O,N as q,O as M,P as U,Q as _,R as k,T as B}from"../chunks/vendor-0d7a9b8a.js";function L(e,t,a){const s=e.slice();return s[13]=t[a],s}function R(e,t,a){const s=e.slice();return s[16]=t[a].from,s[17]=t[a].text,s[18]=t[a].to,s}function w(e){let t,a,s,m,p,b,E,x,y,N,S=e[16]+"",T=e[18]+"",I=e[17]+"";return{c(){t=r("p"),a=o(S),s=o(" → "),m=o(T),b=v(),E=r("p"),x=o(I),y=v(),this.h()},l(e){t=c(e,"P",{class:!0,m:!0});var l=i(t);a=d(l,S),s=d(l," → "),m=d(l,T),l.forEach(n),b=g(e),E=c(e,"P",{class:!0,bg:!0,text:!0,p:!0,border:!0});var r=i(E);x=d(r,I),y=g(r),r.forEach(n),this.h()},h(){h(t,"class",p=e[16]===e[2].name?"self-end":"self-start"),h(t,"m","t-2"),h(E,"class",N=e[16]===e[2].name?"self-end":"self-start"),h(E,"bg","blue-600"),h(E,"text","light-300"),h(E,"p","2"),h(E,"border","rounded")},m(e,n){l(e,t,n),u(t,a),u(t,s),u(t,m),l(e,b,n),l(e,E,n),u(E,x),u(E,y)},p(e,s){1&s&&S!==(S=e[16]+"")&&f(a,S),1&s&&T!==(T=e[18]+"")&&f(m,T),5&s&&p!==(p=e[16]===e[2].name?"self-end":"self-start")&&h(t,"class",p),1&s&&I!==(I=e[17]+"")&&f(x,I),5&s&&N!==(N=e[16]===e[2].name?"self-end":"self-start")&&h(E,"class",N)},d(e){e&&n(t),e&&n(b),e&&n(E)}}}function A(e){let t,a,s=e[17]+"";return{c(){t=r("p"),a=o(s),this.h()},l(e){t=c(e,"P",{bg:!0,m:!0,p:!0,border:!0});var l=i(t);a=d(l,s),l.forEach(n),this.h()},h(){h(t,"bg","orange-600"),h(t,"m","t-2"),h(t,"p","2"),h(t,"border","rounded")},m(e,s){l(e,t,s),u(t,a)},p(e,t){1&t&&s!==(s=e[17]+"")&&f(a,s)},d(e){e&&n(t)}}}function D(e){let t;function a(e,t){return"Server"===e[16]?A:w}let r=a(e),o=r(e);return{c(){o.c(),t=s()},l(e){o.l(e),t=s()},m(e,a){o.m(e,a),l(e,t,a)},p(e,s){r===(r=a(e))&&o?o.p(e,s):(o.d(1),o=r(e),o&&(o.c(),o.m(t.parentNode,t)))},d(e){o.d(e),e&&n(t)}}}function V(e){let t,a,s,v;return{c(){t=r("p"),a=o(e[5]),this.h()},l(s){t=c(s,"P",{p:!0,bg:!0,text:!0});var l=i(t);a=d(l,e[5]),l.forEach(n),this.h()},h(){h(t,"p","4"),h(t,"bg","red-600"),h(t,"text","light-300")},m(e,s){l(e,t,s),u(t,a),v=!0},p(e,t){(!v||32&t)&&f(a,e[5])},i(e){v||(m((()=>{s||(s=p(t,T,{},!0)),s.run(1)})),v=!0)},o(e){s||(s=p(t,T,{},!1)),s.run(0),v=!1},d(e){e&&n(t),e&&s&&s.end()}}}function $(e){let t,a,s,p,b,E,x,y,N,S,T,I,P,R,w,A,D,V,$=e[2].name+"",J=[],W=new Map,H=e[4];const j=e=>e[13].name;for(let l=0;l<H.length;l+=1){let t=L(e,H,l),a=j(t);W.set(a,J[l]=F(a,t))}return{c(){t=r("p"),a=o("Welcome, "),s=o($),p=v(),b=r("select");for(let e=0;e<J.length;e+=1)J[e].c();E=v(),x=r("form"),y=r("label"),N=o("Message"),S=v(),T=r("div"),I=r("input"),P=v(),R=r("button"),w=o("Send Message"),this.h()},l(e){t=c(e,"P",{});var l=i(t);a=d(l,"Welcome, "),s=d(l,$),l.forEach(n),p=g(e),b=c(e,"SELECT",{class:!0});var r=i(b);for(let t=0;t<J.length;t+=1)J[t].l(r);r.forEach(n),E=g(e),x=c(e,"FORM",{});var o=i(x);y=c(o,"LABEL",{for:!0});var h=i(y);N=d(h,"Message"),h.forEach(n),S=g(o),T=c(o,"DIV",{});var u=i(T);I=c(u,"INPUT",{id:!0,type:!0,class:!0}),P=g(u),R=c(u,"BUTTON",{type:!0,class:!0});var f=i(R);w=d(f,"Send Message"),f.forEach(n),u.forEach(n),o.forEach(n),this.h()},h(){h(b,"class","svelte-1lavqcd"),void 0===e[3].to&&m((()=>e[9].call(b))),h(y,"for","message"),h(I,"id","message"),h(I,"type","text"),h(I,"class","svelte-1lavqcd"),R.disabled=A=e[3].text.length<1,h(R,"type","submit"),h(R,"class","svelte-1lavqcd")},m(n,r){l(n,t,r),u(t,a),u(t,s),l(n,p,r),l(n,b,r);for(let e=0;e<J.length;e+=1)J[e].m(b,null);O(b,e[3].to),l(n,E,r),l(n,x,r),u(x,y),u(y,N),u(x,S),u(x,T),u(T,I),q(I,e[3].text),u(T,P),u(T,R),u(R,w),D||(V=[M(b,"change",e[9]),M(I,"input",e[10]),M(x,"submit",U(e[6]))],D=!0)},p(e,t){4&t&&$!==($=e[2].name+"")&&f(s,$),20&t&&(H=e[4],J=_(J,t,j,1,e,H,W,b,B,F,null,L)),24&t&&O(b,e[3].to),24&t&&I.value!==e[3].text&&q(I,e[3].text),24&t&&A!==(A=e[3].text.length<1)&&(R.disabled=A)},d(e){e&&n(t),e&&n(p),e&&n(b);for(let t=0;t<J.length;t+=1)J[t].d();e&&n(E),e&&n(x),D=!1,k(V)}}}function J(e){let t,a,s,f,m,p,b,E,x,y,N,S,T,I;return{c(){t=r("form"),a=r("label"),s=o("Username"),f=v(),m=r("div"),p=r("input"),b=v(),E=r("button"),x=o("Request Username"),N=v(),S=r("br"),this.h()},l(e){t=c(e,"FORM",{});var l=i(t);a=c(l,"LABEL",{for:!0});var r=i(a);s=d(r,"Username"),r.forEach(n),f=g(l),m=c(l,"DIV",{m:!0});var o=i(m);p=c(o,"INPUT",{id:!0,type:!0,class:!0}),b=g(o),E=c(o,"BUTTON",{type:!0,class:!0});var h=i(E);x=d(h,"Request Username"),h.forEach(n),o.forEach(n),l.forEach(n),N=g(e),S=c(e,"BR",{}),this.h()},h(){var t;h(a,"for","username"),h(p,"id","username"),h(p,"type","text"),h(p,"class","svelte-1lavqcd"),E.disabled=y=(null==(t=e[1])?void 0:t.length)<1,h(E,"type","submit"),h(E,"class","svelte-1lavqcd"),h(m,"m","t-2")},m(n,r){l(n,t,r),u(t,a),u(a,s),u(t,f),u(t,m),u(m,p),q(p,e[1]),u(m,b),u(m,E),u(E,x),l(n,N,r),l(n,S,r),T||(I=[M(p,"input",e[8]),M(t,"submit",U(e[7]))],T=!0)},p(e,t){var a;2&t&&p.value!==e[1]&&q(p,e[1]),2&t&&y!==(y=(null==(a=e[1])?void 0:a.length)<1)&&(E.disabled=y)},d(e){e&&n(t),e&&n(N),e&&n(S),T=!1,k(I)}}}function W(e){let t,a,s,m=e[13].name+"";return{c(){t=r("option"),a=o(m),this.h()},l(e){t=c(e,"OPTION",{class:!0});var s=i(t);a=d(s,m),s.forEach(n),this.h()},h(){t.__value=s=e[13].name,t.value=t.__value,h(t,"class","svelte-1lavqcd")},m(e,s){l(e,t,s),u(t,a)},p(e,l){16&l&&m!==(m=e[13].name+"")&&f(a,m),16&l&&s!==(s=e[13].name)&&(t.__value=s,t.value=t.__value)},d(e){e&&n(t)}}}function F(e,t){let a,r,o="Server"!=t[13].name&&t[13].name!=t[2].name&&W(t);return{key:e,first:null,c(){a=s(),o&&o.c(),r=s(),this.h()},l(e){a=s(),o&&o.l(e),r=s(),this.h()},h(){this.first=a},m(e,t){l(e,a,t),o&&o.m(e,t),l(e,r,t)},p(e,a){"Server"!=(t=e)[13].name&&t[13].name!=t[2].name?o?o.p(t,a):(o=W(t),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},d(e){e&&n(a),o&&o.d(e),e&&n(r)}}}function H(e){let t,a,s,m,p,N,S,T,P,O,q,M,U,_=e[4].length-2+"",k=e[0],B=[];for(let l=0;l<k.length;l+=1)B[l]=D(R(e,k,l));let L=e[5]&&V(e);function w(e,t){return e[2].name?$:J}let A=w(e),W=A(e);return{c(){t=r("div"),a=r("p"),s=o("Number of users: "),m=o(_),p=v(),N=r("div"),S=r("p"),T=o("Start of conversation"),P=v();for(let e=0;e<B.length;e+=1)B[e].c();O=v(),L&&L.c(),q=v(),M=r("div"),W.c(),this.h()},l(e){t=c(e,"DIV",{bg:!0,p:!0});var l=i(t);a=c(l,"P",{text:!0});var r=i(a);s=d(r,"Number of users: "),m=d(r,_),r.forEach(n),l.forEach(n),p=g(e),N=c(e,"DIV",{id:!0,display:!0,flex:!0,p:!0,overflow:!0,class:!0});var o=i(N);S=c(o,"P",{font:!0});var h=i(S);T=d(h,"Start of conversation"),h.forEach(n),P=g(o);for(let t=0;t<B.length;t+=1)B[t].l(o);o.forEach(n),O=g(e),L&&L.l(e),q=g(e),M=c(e,"DIV",{bg:!0,p:!0});var u=i(M);W.l(u),u.forEach(n),this.h()},h(){h(a,"text","light-300"),h(t,"bg","dark-300"),h(t,"p","4"),h(S,"font","italic"),h(N,"id","messages"),h(N,"display","flex"),h(N,"flex","1 col"),h(N,"p","y-4 l-4"),h(N,"overflow","y-scroll"),h(N,"class","svelte-1lavqcd"),h(M,"bg","dark-300"),h(M,"p","4")},m(e,n){l(e,t,n),u(t,a),u(a,s),u(a,m),l(e,p,n),l(e,N,n),u(N,S),u(S,T),u(N,P);for(let t=0;t<B.length;t+=1)B[t].m(N,null);l(e,O,n),L&&L.m(e,n),l(e,q,n),l(e,M,n),W.m(M,null),U=!0},p(e,[t]){if((!U||16&t)&&_!==(_=e[4].length-2+"")&&f(m,_),5&t){let a;for(k=e[0],a=0;a<k.length;a+=1){const s=R(e,k,a);B[a]?B[a].p(s,t):(B[a]=D(s),B[a].c(),B[a].m(N,null))}for(;a<B.length;a+=1)B[a].d(1);B.length=k.length}e[5]?L?(L.p(e,t),32&t&&b(L,1)):(L=V(e),L.c(),b(L,1),L.m(q.parentNode,q)):L&&(I(),E(L,1,1,(()=>{L=null})),x()),A===(A=w(e))&&W?W.p(e,t):(W.d(1),W=A(e),W&&(W.c(),W.m(M,null)))},i(e){U||(b(L),U=!0)},o(e){E(L),U=!1},d(e){e&&n(t),e&&n(p),e&&n(N),y(B,e),e&&n(O),L&&L.d(e),e&&n(q),e&&n(M),W.d()}}}function j(e,t,a){let s=`Guest #${(9999*Math.random()).toFixed(0)}`;const l={name:""},n={from:"",text:"Hello, World!",to:"All"};let r,o=[{name:"All"},{name:"Server"}],c="",i=[];return N((()=>{r=new WebSocket("ws://localhost:8080"),r.onmessage=function(e){const t=JSON.parse(e.data);if("message"===t.type){const e=t.data;a(0,i=[...i,e])}else if("update"===t.type){const e=t.data;t.success?(a(2,l.name=e.name,l),a(3,n.from=e.name,n)):(a(5,c="That username is taken!"),setTimeout((()=>a(5,c="")),2500))}else"list"===t.type&&(a(4,o=t.data),a(3,n.to=-1!=o.findIndex((e=>e.name===n.to))?n.to:"All",n))}})),e.$$.update=()=>{1&e.$$.dirty&&i&&S((()=>{const e=document.getElementById("messages");e.scrollTop=e.scrollHeight}))},[i,s,l,n,o,c,function(){const e={type:"message",data:n};r.send(JSON.stringify(e)),a(3,n.text="",n)},function(){const e={type:"update",data:{name:s}};r.send(JSON.stringify(e))},function(){s=this.value,a(1,s)},function(){n.to=P(this),a(3,n),a(4,o)},function(){n.text=this.value,a(3,n),a(4,o)}]}export default class extends e{constructor(e){super(),t(this,e,j,H,a,{})}}
